(function(){"use strict";function D(o,t){if(o===void 0)return;const{data:s,width:n,height:a}=o,u=[],X=[];for(let r=0;r<t;r++)for(let c=0;c<t;c++){const h=Math.floor(c*n/t),i=Math.min(Math.floor((c+1)*n/t),n),d=Math.floor(r*a/t),g=Math.min(Math.floor((r+1)*a/t),a);X.push({startX:h,endX:i,startY:d,endY:g})}for(const r of X){const{startX:c,endX:h,startY:i,endY:d}=r,g=h-c,N=d-i,v=g*N;if(v===0){const e=(i*n+c)*4,f=s[e],l=s[e+1],Y=s[e+2],[m,M,p]=x(f,l,Y);u.push([m,M,p]);continue}let y=0,w=0,z=0;for(let e=i;e<d;e++)for(let f=c;f<h;f++){const l=(e*n+f)*4,Y=s[l],m=s[l+1],M=s[l+2],[p,b,k]=x(Y,m,M);y+=p,w+=b,z+=k}const T=y/v,U=w/v,V=z/v;u.push([T,U,V])}return u}function x(o,t,s){const n=.299*o+.587*t+.114*s,a=-.14713*o-.28886*t+.436*s,u=.615*o-.51499*t-.10001*s;return[n,a,u]}function I(o){const{imageData:t,size:s}=o;return D(t,s)}self.onmessage=o=>{const{inputData:t,hash:s}=o.data,n=I(t);self.postMessage({result:n,hash:s})}})();

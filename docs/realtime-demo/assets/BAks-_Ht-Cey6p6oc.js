import{u as d,l,n as h,U as u,c as f}from"./index-D-BKjTUD.js";var p=Object.defineProperty,w=(s,e,i)=>e in s?p(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,c=(s,e,i)=>w(s,typeof e!="symbol"?e+"":e,i);async function v(s,e){const{FaceMesh:i}=await h(),a=new i({locateFile:t=>{switch(e){case d.CDN:return`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${t}`;case d.SelfHosted:const{protocol:r,host:o}=window.location,n=`models/mediapipe/${t}`,m=u.loadModelsFromRoot?`${r}//${o}/`:document.baseURI;return new URL(n,m).href}}});return a.onResults(t=>{const r=t.image;if(t.multiFaceLandmarks===void 0)return s({faceBox:void 0,landmarks:[],videoFrame:r});const o=t.multiFaceLandmarks[0];if(!o||o.length===0)return s({faceBox:void 0,landmarks:[],videoFrame:r});let n=f(o);s({faceBox:n,landmarks:o,videoFrame:r})}),a}class F{constructor(){c(this,"faceMesh"),c(this,"promise"),c(this,"modelLocation",d.CDN)}async loadModels(e){this.faceMesh=await v(a=>{this.promise!==void 0&&(this.promise(a),this.promise=void 0)},e||this.modelLocation),await new Promise(a=>setTimeout(a,1e3));const i=await l();await this.faceMesh.send({image:i}),await new Promise(a=>setTimeout(a,2e3)),console.log("MediaPipe models loaded")}detect(e){return new Promise((i,a)=>{if(this.faceMesh===void 0){a(new Error("MediaPipe face mesh detector not ready"));return}this.promise=i,this.faceMesh.send(e).catch(a)})}}export{F as MediaPipeFaceDetector};

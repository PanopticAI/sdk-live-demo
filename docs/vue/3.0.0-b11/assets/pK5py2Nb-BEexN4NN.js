import{e as s,t as d,b as l}from"./index-DvXIqUHB.js";import{A as h,c as m}from"./DNiMR7Uc-BCxaXHv6.js";var f=Object.defineProperty,g=(i,t,e)=>t in i?f(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,n=(i,t,e)=>g(i,typeof t!="symbol"?t+"":t,e);class b{constructor(){n(this,"faceDetector"),n(this,"runningMode","IMAGE"),n(this,"modelLocation",s.CDN),console.log("[MPFaceDetector] Created.")}modelAssetPath(t){switch(t||this.modelLocation){case s.CDN:return"https://storage.googleapis.com/mediapipe-models/face_detector/blaze_face_short_range/float16/1/blaze_face_short_range.tflite";case s.SelfHosted:const{protocol:e,host:a}=window.location;return`${e}//${a}/models/mpvision/face_detector/blaze_face_short_range/float16/1/blaze_face_short_range.tflite`}}async initializefaceDetector(t){const e=t||this.modelLocation,a=(()=>{switch(e){case s.CDN:return"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.9/wasm";case s.SelfHosted:const{protocol:r,host:c}=location;return`${r}//${c}/models/mpvision/tasks-vision@0.10.9/wasm`}})(),o=await h.forVisionTasks(a);this.faceDetector=await m.createFromOptions(o,{baseOptions:{modelAssetPath:this.modelAssetPath(t),delegate:"GPU"},runningMode:this.runningMode})}async loadModels(t){await this.initializefaceDetector(t);const e=await d();await this.detect({image:e})}async detect(t){const e=l(t);if(this.faceDetector===void 0)return{faceBox:void 0,landmarks:[],videoFrame:e};const a=this.faceDetector.detect(e).detections;if(a.length===0)return{faceBox:void 0,landmarks:[],videoFrame:e};const o=a[0];return o.boundingBox===void 0?{faceBox:void 0,landmarks:[],videoFrame:e}:{faceBox:{xCenter:(o.boundingBox.originX+o.boundingBox.width/2)/e.width,yCenter:(o.boundingBox.originY+o.boundingBox.height/2)/e.height,width:o.boundingBox.width/e.width,height:o.boundingBox.height/e.height},landmarks:[],videoFrame:e}}}export{b as MPVisionFaceDetector};

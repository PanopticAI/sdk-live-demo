(function(){"use strict";(function(){function x(i,h){if(h.length===0)return{x:0,y:0,w:0,h:0};if(h.length===1){const a=h[0];return{x:Math.floor(a.x)*i.width,y:Math.floor(a.y)*i.height,w:1,h:1}}let e=h[0].x,n=h[0].y,s=h[0].x,r=h[0].y;for(let a=1;a<h.length;a++){const t=h[a];t.x<e&&(e=t.x),t.y<n&&(n=t.y),t.x>s&&(s=t.x),t.y>r&&(r=t.y)}return{x:e*i.width,y:n*i.height,w:(s-e)*i.width,h:(r-n)*i.height}}function w(i){var h;const{videoFrame:e,normalizedPoints:n}=i,{x:s,y:r,w:a,h:t}=x(e,n),l=new OffscreenCanvas(e.width,e.height);(h=l.getContext("2d"))==null||h.putImageData(e,0,0);let o=new OffscreenCanvas(a,t).getContext("2d");o.beginPath();for(let g=0;g<n.length;g++){const f=n[g],c=(f.x-s/e.width)*(e.width/a)*a,u=(f.y-r/e.height)*(e.height/t)*t;g===0?o.moveTo(c,u):o.lineTo(c,u)}return o.closePath(),o.clip(),o.drawImage(l,s,r,a,t,0,0,a,t),o.getImageData(0,0,a,t)}self.onmessage=i=>{const{inputData:h,hash:e}=i.data,n=w(h);self.postMessage({result:n,hash:e},[n.data.buffer])}})()})();

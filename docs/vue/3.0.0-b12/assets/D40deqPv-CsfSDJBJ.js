import{e as c,r as m,n as l,a as h}from"./index-ySnX5Fxk.js";var u=Object.defineProperty,f=(t,e,i)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,n=(t,e,i)=>f(t,typeof e!="symbol"?e+"":e,i);async function p(t,e){const{FaceMesh:i}=await l(),a=new i({locateFile:s=>{switch(e){case c.CDN:return`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${s}`;case c.SelfHosted:const{protocol:r,host:o}=window.location;return`${r}//${o}/models/mediapipe/${s}`}}});return a.onResults(s=>{const r=s.image;if(s.multiFaceLandmarks===void 0)return t({faceBox:void 0,landmarks:[],videoFrame:r});const o=s.multiFaceLandmarks[0];if(!o||o.length===0)return t({faceBox:void 0,landmarks:[],videoFrame:r});let d=h(o);t({faceBox:d,landmarks:o,videoFrame:r})}),a}class v{constructor(){n(this,"faceMesh"),n(this,"promise"),n(this,"modelLocation",c.CDN)}async loadModels(e){this.faceMesh=await p(a=>{this.promise!==void 0&&(this.promise(a),this.promise=void 0)},e||this.modelLocation),await new Promise(a=>setTimeout(a,1e3));const i=await m();await this.faceMesh.send({image:i}),await new Promise(a=>setTimeout(a,2e3)),console.log("MediaPipe models loaded")}detect(e){return new Promise((i,a)=>{if(this.faceMesh===void 0){a(new Error("MediaPipe face mesh detector not ready"));return}this.promise=i,this.faceMesh.send(e).catch(a)})}}export{v as MediaPipeFaceDetector};
